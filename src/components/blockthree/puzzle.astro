---
import "./puzzle.css";
---

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; width: 100%;">
  <h2 style="font-size: 2.5rem; color: #ec4899; margin-bottom: 1rem; font-family: 'Cherry Bomb One', cursive; text-shadow: 2px 2px 4px rgba(0,0,0,0.1);">
    Rompecabezas
  </h2>
  
  <!-- Contenedor principal -->
  <div id="puzzle-container" style="width: 1000px; height: 600px; position: relative; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 16px #0002;">
    
    <!-- Placeholder de carga -->
    <div id="puzzle-placeholder" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #FFBBBB, #FF8F8F); display: flex; justify-content: center; align-items: center; color: white; font-size: 1.2rem; z-index: 2; transition: opacity 0.3s ease;">
      <div style="text-align: center;">
        <div style="width: 40px; height: 40px; border: 3px solid rgba(255,255,255,0.3); border-top: 3px solid white; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 1rem;"></div>
        Cargando puzzle...
      </div>
    </div>
    
    <!-- Iframe precargado pero oculto -->
    <iframe 
      id="puzzle-iframe"
      src="/Puzzlefy-main/index.html?image=/puzzle/rompecabezas.jpg&cols=4&rows=4"
      width="1000"
      height="600"
      style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; opacity: 0; transition: opacity 0.5s ease; z-index: 1;"
      allowfullscreen="true">
    </iframe>
  </div>

  <style>
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>

  <script>
    // Función para manejar la carga del iframe
    function handleIframeLoad() {
      const iframe = document.getElementById('puzzle-iframe');
      const placeholder = document.getElementById('puzzle-placeholder');
      
      if (iframe && placeholder) {
        // Mostrar el iframe gradualmente
        iframe.style.opacity = '1';
        
        // Ocultar el placeholder después de la transición
        setTimeout(() => {
          placeholder.style.opacity = '0';
          setTimeout(() => {
            placeholder.style.display = 'none';
          }, 300);
        }, 500);
      }
    }

    // Escuchar el evento load del iframe
    window.addEventListener('load', function() {
      const iframe = document.getElementById('puzzle-iframe');
      if (iframe) {
        iframe.addEventListener('load', handleIframeLoad);
        
        // Fallback: si el iframe tarda mucho, mostrar después de 3 segundos
        setTimeout(() => {
          if (iframe.style.opacity === '0') {
            handleIframeLoad();
          }
        }, 3000);
      }
    });
  </script>
</div>
